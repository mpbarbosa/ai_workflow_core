# AI Workflow Automation - Artifact Directory

This directory (`.ai_workflow/`) contains execution artifacts generated by the AI Workflow Automation system. These artifacts are automatically managed and should not be manually modified.

## Directory Structure

```
.ai_workflow/
├── backlog/              # Workflow execution reports and step outputs
├── summaries/            # AI-generated summaries per workflow run
├── logs/                 # Detailed execution logs
├── metrics/              # Performance metrics and history
├── checkpoints/          # Checkpoint files for workflow resume
├── prompts/              # AI prompt templates (optional)
└── README.md             # This file
```

## Purpose

The AI Workflow Automation system runs a 15-step validation and enhancement pipeline on your project:

1. **Pre-Analysis** (Step 0) - Analyze recent changes
2. **Documentation** (Steps 1-4) - Update and validate docs
3. **Testing** (Steps 5-7) - Review, generate, and execute tests
4. **Validation** (Steps 8-9) - Dependencies and code quality
5. **Analysis** (Steps 10, 12-14) - Context, linting, prompts, UX
6. **Finalization** (Step 11) - Git operations and commit

## Artifact Management

### Automatic Cleanup (v2.7.0)

The workflow automatically cleans up old artifacts:
- **Default retention**: 7 days
- **Configurable**: Use `--cleanup-days N` flag
- **Disable**: Use `--no-cleanup` flag

Cleanup runs after successful workflow completion and removes:
- Old workflow run directories (`workflow_YYYYMMDD_HHMMSS/`)
- Old checkpoint files
- Outdated logs and reports

### Manual Cleanup

To manually clean up artifacts:

```bash
# Remove all artifacts older than 7 days
find .ai_workflow/backlog -type d -mtime +7 -exec rm -rf {} \;
find .ai_workflow/summaries -type d -mtime +7 -exec rm -rf {} \;
find .ai_workflow/logs -type d -mtime +7 -exec rm -rf {} \;
find .ai_workflow/checkpoints -type f -mtime +7 -delete

# Remove all artifacts (nuclear option - use with caution)
rm -rf .ai_workflow/backlog/*
rm -rf .ai_workflow/summaries/*
rm -rf .ai_workflow/logs/*
rm -rf .ai_workflow/metrics/*  # Warning: removes performance history
rm -rf .ai_workflow/checkpoints/*
```

### Disk Space Management

Typical artifact sizes per workflow run:
- Backlog reports: ~100-500 KB
- Summaries: ~10-50 KB
- Logs: ~50-200 KB
- **Total per run**: ~200-800 KB

With 7-day retention at 1 run/day: ~1-6 MB
With 30-day retention at 2 runs/day: ~12-50 MB

## Subdirectory Details

### backlog/

Contains detailed execution reports for each workflow run:

```
backlog/
└── workflow_20251231_185534/
    ├── WORKFLOW_SUMMARY.md           # Overall summary
    ├── step_00_Pre_Analysis.md       # Step 0 report
    ├── step_01_Documentation.md      # Step 1 report
    ├── step_07_Test_Execution.md     # Step 7 report
    ├── CHANGE_ANALYSIS.md            # Change detection results
    └── DEPENDENCY_GRAPH.md           # Dependency visualization
```

**Use Case**: Debugging, historical review, audit trail

### summaries/

Contains AI-generated summaries per workflow run:

```
summaries/
└── workflow_20251231_185534/
    ├── context_summary.md            # Overall context
    ├── test_summary.md               # Test results summary
    └── quality_summary.md            # Code quality summary
```

**Use Case**: Quick overview, status reports, documentation

### logs/

Contains detailed execution logs:

```
logs/
└── workflow_20251231_185534/
    ├── workflow_execution.log        # Main workflow log
    ├── step_01_docs.log              # Step 1 detailed log
    ├── step_07_tests.log             # Test execution log
    └── parallel_tracks.log           # Parallel execution log (if enabled)
```

**Use Case**: Troubleshooting, performance analysis, debugging

### metrics/

Contains performance metrics and historical data:

```
metrics/
├── current_run.json                  # Current workflow run metrics
├── history.jsonl                     # Historical metrics (JSON Lines)
└── summary.md                        # Human-readable metrics summary
```

**Format**: JSON/JSONL for programmatic access
**Retention**: Persistent (not auto-cleaned unless manually deleted)
**Use Case**: Performance tracking, optimization analysis, reporting

#### Metrics Structure

`current_run.json`:
```json
{
  "workflow_run_id": "workflow_20251231_185534",
  "start_time": "2025-12-31T18:55:35-03:00",
  "version": "2.7.0",
  "mode": "auto",
  "steps": {
    "step_0": {
      "name": "Pre_Analysis",
      "status": "success",
      "duration_seconds": 30
    }
  },
  "status": "success",
  "duration_seconds": 930,
  "steps_completed": 15
}
```

`history.jsonl` (one JSON object per line):
```jsonl
{"workflow_run_id":"workflow_20251231_185534","status":"success","duration_seconds":930}
{"workflow_run_id":"workflow_20251231_120000","status":"success","duration_seconds":845}
```

### checkpoints/

Contains checkpoint files for workflow resume capability:

```
checkpoints/
└── workflow_20251231_185534.checkpoint
```

**Format**: Shell script variables
**Use Case**: Resume workflow after interruption, debug specific steps
**Cleanup**: Automatically removed with old workflow runs

### prompts/ (Optional)

Contains AI prompt templates if customized:

```
prompts/
└── workflow_20251231_185534/
    ├── documentation_specialist.txt
    └── test_engineer.txt
```

**Use Case**: Custom AI personas, prompt engineering, reproducibility

## Git Integration

### What to Commit

**DO commit**:
- `.ai_workflow/README.md` - This documentation
- `.workflow-config.yaml` - Project configuration (if exists)

**DO NOT commit** (already in .gitignore):
- `backlog/` - Too large, frequently changing
- `summaries/` - Generated artifacts
- `logs/` - Execution-specific, not source code
- `metrics/` - Performance data, not source code
- `checkpoints/` - Temporary state, not source code
- `.ai_cache/` - AI response cache, temporary

### .gitignore Configuration

Ensure your project's `.gitignore` includes:

```gitignore
# AI Workflow artifacts
.ai_workflow/backlog/
.ai_workflow/summaries/
.ai_workflow/logs/
.ai_workflow/metrics/
.ai_workflow/checkpoints/
.ai_workflow/.ai_cache/
```

## Workflow Configuration

### Project-Specific Configuration

Create `.workflow-config.yaml` in your project root:

```yaml
# Project metadata
project:
  name: "my-project"
  kind: "nodejs_api"  # or: shell_automation, static_website, etc.

# Technology stack
tech_stack:
  primary_language: "javascript"
  frameworks: ["express", "jest"]

# Testing configuration
testing:
  framework: "jest"
  coverage_target: 90
  test_command: "npm test"
  
# Workflow behavior
workflow:
  smart_execution: true
  parallel_execution: true
  ai_cache_enabled: true
  cleanup_days: 7
```

### Command-Line Options

Control workflow behavior with flags:

```bash
# Performance optimization
--parallel-tracks           # 46% faster (3-track parallelization)
--smart-execution           # Skip unnecessary steps (40-85% faster)
--no-ai-cache              # Disable AI response caching

# Artifact management
--cleanup-days 14          # Custom retention period
--no-cleanup               # Disable automatic cleanup

# Quality gates
--enhanced-validations     # Enable 4 additional validation checks
--strict-validations       # Fail workflow if validations fail

# Execution control
--auto                     # Automatic mode (no prompts)
--dry-run                  # Preview without execution
--steps 0,5,6,7           # Execute specific steps only
--no-resume                # Fresh start (ignore checkpoints)
```

## Troubleshooting

### Workflow Fails to Resume

**Symptom**: Workflow doesn't resume from checkpoint

**Solution**:
1. Check if checkpoint file exists: `.ai_workflow/checkpoints/workflow_*.checkpoint`
2. Verify checkpoint is for the same `WORKFLOW_RUN_ID`
3. Use `--no-resume` to force fresh start

### Disk Space Issues

**Symptom**: `.ai_workflow/` directory grows too large

**Solution**:
1. Check retention policy: `--cleanup-days` value
2. Manually clean old artifacts: `find .ai_workflow/backlog -mtime +7 -delete`
3. Reduce workflow frequency
4. Enable automatic cleanup: Remove `--no-cleanup` flag

### Metrics Not Collecting

**Symptom**: `history.jsonl` is empty or not updating

**Solution**:
1. Run enhanced validations: `--enhanced-validations`
2. Check metrics health: Look for "Metrics Health Check" in output
3. Verify `METRICS_DIR` is set correctly
4. Check file permissions: `ls -la .ai_workflow/metrics/`

### Step Execution Logs Missing

**Symptom**: Can't find logs for a specific step

**Solution**:
1. Check workflow run directory: `.ai_workflow/logs/workflow_YYYYMMDD_HHMMSS/`
2. Verify step actually executed (check workflow summary)
3. Check if step was skipped due to smart execution
4. Review main workflow log: `workflow_execution.log`

## Performance Tips

1. **Use parallelization**: Add `--parallel-tracks` for 46% speedup
2. **Enable smart execution**: Add `--smart-execution` for incremental changes
3. **Cache AI responses**: Keep AI cache enabled (default)
4. **Selective steps**: Use `--steps` for targeted workflows
5. **Regular cleanup**: Monitor disk space, adjust retention policy

## Security Considerations

### Sensitive Data

The `.ai_workflow/` directory may contain:
- Code snippets in backlog reports
- Git commit messages in logs
- File paths and structure information

**Recommendations**:
1. Never commit `.ai_workflow/` artifacts to version control
2. Exclude from backups if containing sensitive data
3. Use `.gitignore` to prevent accidental commits
4. Review logs before sharing for debugging

### Access Control

If multiple users run workflows:
1. Set appropriate permissions: `chmod 700 .ai_workflow/`
2. Use separate workflow runs per user
3. Consider user-specific artifact directories
4. Review shared checkpoint behavior

## Additional Resources

- **Main Documentation**: `docs/PROJECT_REFERENCE.md`
- **Quick Start**: `README.md` in repository root
- **Configuration Guide**: `docs/TECH_STACK_ADAPTIVE_FRAMEWORK.md`
- **Performance Guide**: `PARALLELIZATION_ANALYSIS.md`
- **Validation Guide**: `ENHANCED_VALIDATIONS_IMPLEMENTATION.md`

## Support

For issues or questions:
1. Check documentation in `docs/workflow-automation/`
2. Review implementation docs: `*_IMPLEMENTATION.md` files
3. Run workflow with `--help` for command-line options
4. Enable `--verbose` for detailed logging

---

**Version**: 2.7.0  
**Last Updated**: 2025-12-31  
**Maintained by**: AI Workflow Automation Project

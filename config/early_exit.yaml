# Early Exit Conditions Configuration
# Version: 1.0.0
# Purpose: Define conditions for skipping steps based on previous step results

# ==============================================================================
# EARLY EXIT CONDITIONS
# ==============================================================================
# Conditions are evaluated before executing each step
# If condition evaluates to TRUE, the step is SKIPPED
# If condition evaluates to FALSE, the step is EXECUTED
#
# Condition Syntax:
#   variable operator value
#
# Supported Operators:
#   <, >, <=, >=, ==, !=
#
# Variable References:
#   step_N.key - Reference a result from step N
#   Examples:
#     step_7.test_failures - Number of test failures from step 7
#     step_2.total_issues - Total issues from step 2
#
# ==============================================================================

early_exit_conditions:
  # Step 8: Dependency Validation
  # Skip if test failures are severe (> 50 failures indicates broken tests)
  step_8:
    condition: "step_7.test_failures > 50"
    reason: "Too many test failures - fix tests before checking dependencies"
    enabled: true

  # Step 9: Code Quality Validation
  # Skip if test failures are severe
  step_9:
    condition: "step_7.test_failures > 50"
    reason: "Too many test failures - fix tests before quality checks"
    enabled: true

  # Step 10: Context Analysis
  # Skip if validation steps found major issues (> 100 combined issues)
  step_10:
    condition: "step_2.total_issues + step_3.total_issues + step_4.total_issues > 100"
    reason: "Too many validation issues - fix documentation first"
    enabled: true

  # Step 11.7: Front-End Development Analysis
  # Skip if no front-end files were changed
  step_11_7:
    condition: "step_0.frontend_files_changed == 0"
    reason: "No front-end changes detected"
    enabled: true

  # Step 12: Version Update
  # Skip if any previous step failed critically
  step_12:
    condition: "step_7.critical_failures > 0"
    reason: "Critical test failures - cannot version bump"
    enabled: true

# ==============================================================================
# THRESHOLD CONFIGURATION
# ==============================================================================
# Define threshold values referenced in conditions

thresholds:
  # Test execution thresholds
  test_failures_severe: 50        # More than this triggers early exit
  test_failures_warning: 10       # More than this triggers warning
  
  # Validation thresholds
  validation_issues_severe: 100   # Combined issues that trigger early exit
  validation_issues_warning: 25   # Combined issues that trigger warning
  
  # Documentation thresholds
  broken_links_severe: 20         # More than this triggers early exit
  broken_links_warning: 5         # More than this triggers warning

# ==============================================================================
# STEP DEPENDENCIES
# ==============================================================================
# Define which steps must complete successfully before others can run

dependencies:
  step_8:
    requires:
      - step_7  # Test Execution must complete
    optional: false
    
  step_9:
    requires:
      - step_7  # Test Execution must complete
    optional: false
    
  step_10:
    requires:
      - step_2  # Consistency Analysis
      - step_3  # Script Reference Validation
      - step_4  # Directory Structure Validation
    optional: false
    
  step_12:
    requires:
      - step_7  # Test Execution
      - step_9  # Code Quality
    optional: false

# ==============================================================================
# FAIL-FAST CONFIGURATION
# ==============================================================================
# Define critical failures that should stop the entire workflow

fail_fast:
  # Stop workflow immediately if these conditions are met
  critical_conditions:
    - condition: "step_7.test_failures > 100"
      reason: "More than 100 test failures - workflow cannot continue"
      
    - condition: "step_2.broken_links > 50"
      reason: "More than 50 broken links - documentation severely broken"
      
    - condition: "step_9.critical_violations > 10"
      reason: "More than 10 critical code quality violations"

  # Enable/disable fail-fast mode
  enabled: false  # Default: continue workflow even with failures

# ==============================================================================
# NOTIFICATION CONFIGURATION
# ==============================================================================
# Configure when to send notifications about early exits

notifications:
  # Notify when steps are skipped due to early exit
  on_early_exit: true
  
  # Notify when thresholds are exceeded
  on_threshold_warning: true
  
  # Notification methods (future enhancement)
  methods:
    - console  # Always enabled
    # - email   # Future enhancement
    # - slack   # Future enhancement

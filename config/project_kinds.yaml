# Project Kind Configuration Schema
# Version: 1.2.0
# Purpose: Define validation rules, test commands, and quality standards per project kind
# Last Updated: 2026-01-30

# ============================================================================
# PROJECT KIND DEFINITIONS
# ============================================================================

project_kinds:
  
  # ----------------------------------------------------------------------------
  # Shell Script Automation Project
  # ----------------------------------------------------------------------------
  shell_script_automation:
    name: "Shell Script Automation"
    description: "Bash/shell script based automation tools and utilities"
    
    # Validation rules
    validation:
      required_files:
        - "*.sh"
      required_directories:
        - "src"
      optional_files:
        - "README.md"
        - ".gitignore"
      file_patterns:
        - "*.sh"
        - "*.bash"
    
    # Test execution configuration
    testing:
      test_framework: "bash_unit"
      test_directory: "tests"
      test_file_pattern: "test_*.sh"
      test_command: "bash"
      coverage_required: false
      coverage_threshold: 0
      
    # Quality standards
    quality:
      linters:
        - name: "shellcheck"
          enabled: true
          command: "shellcheck"
          args: ["-x", "-S", "warning"]
          file_pattern: "*.sh"
        - name: "shfmt"
          enabled: false
          command: "shfmt"
          args: ["-d", "-i", "4"]
          file_pattern: "*.sh"
      
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
    
    # Dependencies configuration
    dependencies:
      package_files: []
      lock_files: []
      validation_required: false
    
    # Build configuration
    build:
      required: false
      build_command: ""
      output_directory: ""
    
    # Deployment configuration  
    deployment:
      type: "script"
      requires_build: false
      artifact_patterns: ["*.sh"]
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "BATS testing conventions and best practices"
        - "Test with set -euo pipefail for strict error handling"
        - "Mock external commands and dependencies"
        - "Test both success and failure scenarios"
      
      style_guides:
        - "Google Shell Style Guide"
        - "ShellCheck recommendations"
      
      best_practices:
        - "Quote all variable expansions: \"${var}\""
        - "Use [[ ]] for conditionals instead of [ ]"
        - "Use functions for code organization"
        - "Add error handling with trap"
        - "Use local for function variables"
        - "Avoid eval and command substitution pitfalls"
      
      directory_standards:
        - "Separate source (src/), tests (tests/), and docs (docs/)"
        - "Keep scripts in bin/ or scripts/ directory"
        - "Configuration files in config/ or root"
        - "Library modules in lib/"

  # ----------------------------------------------------------------------------
  # Node.js API Project
  # ----------------------------------------------------------------------------
  nodejs_api:
    name: "Node.js API"
    description: "Node.js backend API with Express or similar framework"
    
    validation:
      required_files:
        - "package.json"
        - "server.js|app.js|index.js"
      required_directories:
        - "src|lib|routes"
      optional_files:
        - "README.md"
        - ".env.example"
        - "docker-compose.yml"
      file_patterns:
        - "*.js"
        - "*.ts"
        - "*.mjs"
    
    testing:
      test_framework: "jest|mocha|vitest"
      test_directory: "test|tests|__tests__"
      test_file_pattern: "*.test.js|*.spec.js|*.test.ts|*.spec.ts"
      test_command: "npm test"
      coverage_required: true
      coverage_threshold: 80
      
    quality:
      linters:
        - name: "eslint"
          enabled: true
          command: "npx eslint"
          args: ["."]
          file_pattern: "*.js|*.ts"
        - name: "prettier"
          enabled: true
          command: "npx prettier"
          args: ["--check", "."]
          file_pattern: "*.js|*.ts|*.json"
      
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      api_documentation_required: true
      api_documentation_format: "openapi|swagger|jsdoc"
    
    dependencies:
      package_files: ["package.json"]
      lock_files: ["package-lock.json", "yarn.lock", "pnpm-lock.yaml"]
      validation_required: true
      security_audit_required: true
      audit_command: "npm audit"
    
    build:
      required: false  # May be true for TypeScript
      build_command: "npm run build"
      output_directory: "dist|build"
    
    deployment:
      type: "service"
      requires_build: false
      artifact_patterns: ["package.json", "*.js", "src/**/*"]
      environment_required: true
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Jest/Vitest/Mocha best practices"
        - "Supertest for API endpoint testing"
        - "Mock external services and databases"
        - "Test middleware and error handlers"
        - "Use fixtures for test data"
      
      style_guides:
        - "Airbnb JavaScript Style Guide"
        - "Node.js Best Practices"
        - "Express.js security best practices"
      
      best_practices:
        - "Use async/await for async operations"
        - "Handle errors with proper HTTP status codes"
        - "Validate input with middleware (joi, express-validator)"
        - "Use environment variables for configuration"
        - "Implement proper logging (winston, pino)"
        - "Follow RESTful API design principles"
      
      directory_standards:
        - "Separate routes/, controllers/, models/, services/"
        - "Configuration in config/ directory"
        - "Middleware in middleware/ directory"
        - "Tests parallel to src/ structure"

  # ----------------------------------------------------------------------------
  # Node.js Automation / CLI Tool Project
  # ----------------------------------------------------------------------------
  nodejs_automation:
    name: "Node.js Automation / CLI Tool"
    description: "Node.js CLI tool or automation framework (e.g., AI workflow, DevOps tooling, build tools)"

    validation:
      required_files:
        - "package.json"
        - "src/index.js|src/index.ts|bin/*.js"
      required_directories:
        - "src|lib"
      optional_files:
        - "README.md"
        - ".workflow-config.yaml"
        - "CHANGELOG.md"
      file_patterns:
        - "*.js"
        - "*.ts"
        - "*.mjs"

    testing:
      test_framework: "jest|mocha|vitest"
      test_directory: "test|tests|__tests__"
      test_file_pattern: "*.test.js|*.spec.js|*.test.ts|*.spec.ts"
      test_command: "npm test"
      coverage_required: true
      coverage_threshold: 80

    quality:
      linters:
        - name: "eslint"
          enabled: true
          command: "npx eslint"
          args: ["."]
          file_pattern: "*.js|*.ts"
        - name: "prettier"
          enabled: true
          command: "npx prettier"
          args: ["--check", "."]
          file_pattern: "*.js|*.ts|*.json"

      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      api_documentation_required: true
      api_documentation_format: "jsdoc"

    dependencies:
      package_files: ["package.json"]
      lock_files: ["package-lock.json", "yarn.lock", "pnpm-lock.yaml"]
      validation_required: true
      security_audit_required: true
      audit_command: "npm audit"

    build:
      required: false
      build_command: "npm run build"
      output_directory: "dist|build"

    deployment:
      type: "npm-package"
      requires_build: false
      artifact_patterns: ["package.json", "src/**/*", "bin/**/*"]
      environment_required: false

    ai_guidance:
      testing_standards:
        - "Jest best practices with pure function unit tests"
        - "Separate pure function tests from integration (I/O) tests"
        - "Mock file system, child_process, and external APIs"
        - "Test CLI argument parsing independently"
        - "Use referential transparency: inject time/random as parameters"
      style_guides:
        - "Airbnb JavaScript Style Guide"
        - "Node.js Best Practices"
        - "Commander.js CLI design guidelines"
      best_practices:
        - "Use async/await for all async operations"
        - "Separate pure functions from side-effectful wrappers"
        - "Inject dependencies (time, random, fs) instead of calling directly"
        - "Use commander/yargs/inquirer for CLI interface"
        - "Implement proper logging levels (debug, info, warn, error)"
        - "Handle SIGINT/SIGTERM for graceful shutdown"
        - "Follow conventional commits for changelog automation"
      directory_standards:
        - "Core logic in src/lib/ or src/core/"
        - "CLI entry points in bin/"
        - "Orchestration in src/orchestrator/"
        - "Step implementations in src/steps/"
        - "Tests mirror src/ directory structure in test/"

  # ----------------------------------------------------------------------------
  # Static Website Project
  # ----------------------------------------------------------------------------
  static_website:
    name: "Static Website"
    description: "HTML/CSS/JavaScript static website or portfolio"
    
    validation:
      required_files:
        - "index.html"
      required_directories: []
      optional_files:
        - "README.md"
        - "package.json"
        - "style.css|styles.css"
      file_patterns:
        - "*.html"
        - "*.css"
        - "*.js"
    
    testing:
      test_framework: "none|jest|playwright"
      test_directory: "tests"
      test_file_pattern: "*.test.js|*.spec.js"
      test_command: "npm test"
      coverage_required: false
      coverage_threshold: 0
      
    quality:
      linters:
        - name: "htmlhint"
          enabled: true
          command: "npx htmlhint"
          args: ["**/*.html"]
          file_pattern: "*.html"
        - name: "stylelint"
          enabled: true
          command: "npx stylelint"
          args: ["**/*.css"]
          file_pattern: "*.css"
        - name: "eslint"
          enabled: false
          command: "npx eslint"
          args: ["."]
          file_pattern: "*.js"
      
      documentation_required: true
      inline_comments_recommended: false
      readme_required: true
      accessibility_required: true
      wcag_level: "AA"
    
    dependencies:
      package_files: ["package.json"]
      lock_files: ["package-lock.json", "yarn.lock"]
      validation_required: false
    
    build:
      required: false
      build_command: "npm run build"
      output_directory: "dist|build|public"
    
    deployment:
      type: "static"
      requires_build: false
      artifact_patterns: ["*.html", "*.css", "*.js", "assets/**/*"]
      cdn_compatible: true
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Jest/Vitest for JavaScript testing"
        - "Playwright/Cypress for E2E testing"
        - "Test DOM manipulation and user interactions"
        - "Mock fetch/API calls"
      
      style_guides:
        - "HTML5 semantic markup guidelines"
        - "CSS BEM or OOCSS methodology"
        - "JavaScript ES6+ best practices"
      
      best_practices:
        - "Use semantic HTML elements"
        - "Implement responsive design (mobile-first)"
        - "Optimize images and assets"
        - "Minimize and bundle JavaScript/CSS for production"
        - "Implement proper accessibility (WCAG)"
        - "Use CSS Grid/Flexbox for layouts"
      
      directory_standards:
        - "Separate content (HTML), styles (CSS), scripts (JS)"
        - "Assets in assets/ or public/ directory"
        - "Source in src/, distribution in dist/ or public/"
        - "Documentation in docs/ directory"

  # ----------------------------------------------------------------------------
  # Client-Side SPA Project (Vanilla JS/Bootstrap)
  # ----------------------------------------------------------------------------
  client_spa:
    name: "Client-Side SPA"
    description: "Vanilla JavaScript Single Page Application with Bootstrap/CSS frameworks (no React/Vue/Angular)"
    
    # Validation rules
    validation:
      required_files:
        - "index.html|public/index.html"
        - "package.json"
        - "src/**/*.js"
      required_directories:
        - "src"
        - "public|dist"
      optional_files:
        - "README.md"
        - "vite.config.js|webpack.config.js"
        - "jest.config.js"
        - "eslint.config.js"
        - "sw.js|service-worker.js"
        - ".env.example"
      file_patterns:
        - "*.html"
        - "*.css"
        - "*.js"
        - "*.mjs"
      excluded_patterns:
        - "*.jsx"
        - "*.tsx"
        - "*.vue"
        - "angular.json"
    
    # Test execution configuration
    testing:
      test_framework: "jest|playwright|selenium"
      test_directory: "tests"
      test_file_pattern: "*.test.js|*.spec.js|*.e2e.test.js|test_*.py"
      test_command: "npm test"
      e2e_command: "npm run test:e2e"
      coverage_required: true
      coverage_threshold: 70
      
    # Quality standards
    quality:
      linters:
        - name: "eslint"
          enabled: true
          command: "npx eslint"
          args: ["src/**/*.js"]
          file_pattern: "*.js|*.mjs"
        - name: "htmlhint"
          enabled: true
          command: "npx htmlhint"
          args: ["**/*.html"]
          file_pattern: "*.html"
        - name: "stylelint"
          enabled: true
          command: "npx stylelint"
          args: ["src/styles/**/*.css"]
          file_pattern: "*.css"
      
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      api_documentation_required: true
      accessibility_required: true
      wcag_level: "AA"
    
    # Dependencies configuration
    dependencies:
      package_files: ["package.json"]
      lock_files: ["package-lock.json", "yarn.lock", "pnpm-lock.yaml"]
      validation_required: true
      security_audit_required: true
      audit_command: "npm audit"
    
    # Build configuration
    build:
      required: false  # Optional - supports both static serving and build tools
      build_command: "npm run build"
      output_directory: "dist|build|public"
      dev_server: "npm run dev|python3 -m http.server"
    
    # Deployment configuration  
    deployment:
      type: "static"
      requires_build: false
      artifact_patterns:
        - "public/**/*"
        - "dist/**/*"
        - "index.html"
        - "src/**/*.js"
        - "src/**/*.css"
      cdn_compatible: true
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Jest for unit testing with jsdom environment"
        - "Playwright/Selenium for E2E browser testing"
        - "Test API client with mock responses and fetch mocks"
        - "Test state management and localStorage interactions"
        - "Validate DOM manipulation and event handlers"
        - "Test responsive design breakpoints"
        - "Mock external API calls consistently"
      
      style_guides:
        - "Airbnb JavaScript Style Guide (ES6+)"
        - "Bootstrap 5 Best Practices"
        - "Vanilla JS Best Practices (avoiding jQuery where possible)"
        - "HTML5 semantic markup guidelines"
        - "CSS BEM methodology for custom styles"
      
      best_practices:
        - "Use ES6+ modules (import/export) for code organization"
        - "Implement client-side routing with History API if SPA navigation needed"
        - "Use fetch() API with proper error handling and timeouts"
        - "Implement caching strategy (localStorage/sessionStorage) with TTL"
        - "Use async/await for asynchronous operations"
        - "Implement proper state management (avoid global variables)"
        - "Use Bootstrap utilities before custom CSS"
        - "Optimize bundle size with tree-shaking and code splitting"
        - "Implement proper CORS handling for API consumption"
        - "Use semantic HTML5 elements (nav, main, article, section)"
        - "Follow mobile-first responsive design principles"
        - "Implement proper accessibility (ARIA labels, keyboard navigation)"
        - "Use Service Worker for PWA features (optional)"
        - "Validate forms with HTML5 attributes + JavaScript"
        - "Implement proper error boundaries for API failures"
      
      directory_standards:
        - "HTML entry point in root or public/ directory"
        - "JavaScript modules in src/js/ or src/ directory"
        - "API clients and services in src/services/ directory"
        - "Utility functions in src/utils/ or src/lib/ directory"
        - "Stylesheets in src/styles/ or public/css/ directory"
        - "Static assets in public/ or assets/ directory"
        - "Tests in tests/ directory (unit, integration, e2e)"
        - "Configuration files in root directory"
        - "Build output in dist/ or build/ directory"
        - "Documentation in docs/ directory"
      
      api_integration_patterns:
        - "Create dedicated apiClient.js module for all HTTP requests"
        - "Implement referential transparency (pure functions with dependency injection)"
        - "Use configuration objects for API endpoints and timeouts"
        - "Implement retry logic with exponential backoff"
        - "Handle network errors gracefully with user-friendly messages"
        - "Cache API responses with appropriate TTL strategies"
        - "Use AbortController for request cancellation"
        - "Validate API responses before processing"
      
      state_management_patterns:
        - "Use localStorage for persistent client-side data (with TTL)"
        - "Use sessionStorage for temporary session data"
        - "Implement centralized state management module (e.g., stateManager.js)"
        - "Use event-driven architecture for state change notifications"
        - "Avoid global variables - encapsulate state in modules"
        - "Implement state validation and sanitization"
        - "Clear stale cache data on version updates"

  # ----------------------------------------------------------------------------
  # React/SPA Application
  # ----------------------------------------------------------------------------
  react_spa:
    name: "React SPA"
    description: "Single Page Application using React"
    
    validation:
      required_files:
        - "package.json"
        - "src/App.js|src/App.tsx"
      required_directories:
        - "src"
        - "public"
      optional_files:
        - "README.md"
        - "tsconfig.json"
      file_patterns:
        - "*.jsx"
        - "*.tsx"
        - "*.js"
        - "*.ts"
    
    testing:
      test_framework: "jest|vitest"
      test_directory: "src"
      test_file_pattern: "*.test.js|*.test.tsx|*.spec.js|*.spec.tsx"
      test_command: "npm test"
      coverage_required: true
      coverage_threshold: 70
      
    quality:
      linters:
        - name: "eslint"
          enabled: true
          command: "npx eslint"
          args: ["src"]
          file_pattern: "*.jsx|*.tsx|*.js|*.ts"
        - name: "prettier"
          enabled: true
          command: "npx prettier"
          args: ["--check", "src"]
          file_pattern: "*.jsx|*.tsx|*.js|*.ts"
      
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      component_documentation_required: true
    
    dependencies:
      package_files: ["package.json"]
      lock_files: ["package-lock.json", "yarn.lock", "pnpm-lock.yaml"]
      validation_required: true
      security_audit_required: true
      audit_command: "npm audit"
    
    build:
      required: true
      build_command: "npm run build"
      output_directory: "build|dist"
    
    deployment:
      type: "static"
      requires_build: true
      artifact_patterns: ["build/**/*", "dist/**/*"]
      cdn_compatible: true
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Jest/Vitest with React Testing Library"
        - "Test components in isolation"
        - "Test user interactions and state changes"
        - "Mock API calls and external dependencies"
        - "Snapshot testing for UI components"
      
      style_guides:
        - "Airbnb React/JSX Style Guide"
        - "React Best Practices and Patterns"
      
      best_practices:
        - "Use functional components with hooks"
        - "Implement proper state management (useState, useContext, Redux)"
        - "Optimize re-renders with React.memo and useCallback"
        - "Follow component composition patterns"
        - "Implement proper error boundaries"
        - "Use TypeScript for type safety (if applicable)"
      
      directory_standards:
        - "Components in src/components/ directory"
        - "Pages/Routes in src/pages/ or src/routes/"
        - "Utilities in src/utils/ or src/lib/"
        - "Tests co-located or in __tests__/ directory"

  # ----------------------------------------------------------------------------
  # Python Application
  # ----------------------------------------------------------------------------
  python_app:
    name: "Python Application"
    description: "Python application or script collection"
    
    validation:
      required_files:
        - "*.py"
      required_directories:
        - "src|lib"
      optional_files:
        - "README.md"
        - "requirements.txt"
        - "setup.py"
        - "pyproject.toml"
      file_patterns:
        - "*.py"
    
    testing:
      test_framework: "pytest|unittest"
      test_directory: "tests"
      test_file_pattern: "test_*.py|*_test.py"
      test_command: "pytest"
      coverage_required: true
      coverage_threshold: 80
      
    quality:
      linters:
        - name: "pylint"
          enabled: true
          command: "pylint"
          args: ["src"]
          file_pattern: "*.py"
        - name: "black"
          enabled: true
          command: "black"
          args: ["--check", "src"]
          file_pattern: "*.py"
        - name: "mypy"
          enabled: false
          command: "mypy"
          args: ["src"]
          file_pattern: "*.py"
      
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      docstring_required: true
      docstring_format: "google|numpy|sphinx"
    
    dependencies:
      package_files: ["requirements.txt", "setup.py", "pyproject.toml"]
      lock_files: ["Pipfile.lock", "poetry.lock"]
      validation_required: true
      security_audit_required: true
      audit_command: "pip-audit"
    
    build:
      required: false
      build_command: "python setup.py build"
      output_directory: "build|dist"
    
    deployment:
      type: "application"
      requires_build: false
      artifact_patterns: ["*.py", "src/**/*.py"]
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Pytest best practices with fixtures"
        - "Use parametrize for multiple test cases"
        - "Mock external dependencies with unittest.mock"
        - "Test exceptions and error conditions"
        - "Use pytest-cov for coverage analysis"
      
      style_guides:
        - "PEP 8 - Style Guide for Python Code"
        - "PEP 257 - Docstring Conventions"
        - "Google Python Style Guide"
      
      best_practices:
        - "Use type hints for function signatures"
        - "Follow PEP 8 naming conventions"
        - "Write docstrings for modules, classes, and functions"
        - "Use context managers for resource management"
        - "Prefer list/dict comprehensions over loops (when readable)"
        - "Handle exceptions explicitly (avoid bare except)"
      
      directory_standards:
        - "Source code in src/ or package name directory"
        - "Tests in tests/ directory (parallel structure)"
        - "Scripts in scripts/ or bin/ directory"
        - "Configuration in config/ or root directory"

  # ----------------------------------------------------------------------------
  # Configuration Library (Meta-type for config/template repositories)
  # ----------------------------------------------------------------------------
  configuration_library:
    name: "Configuration Library"
    description: "Template and configuration repository used as Git submodule (e.g., ai_workflow_core itself)"
    
    validation:
      required_files:
        - "README.md"
        - "CHANGELOG.md"
      required_directories:
        - "config"
        - "docs"
      optional_files:
        - ".gitignore"
        - ".workflow-config.yaml"
        - "LICENSE"
      file_patterns:
        - "*.yaml"
        - "*.yml"
        - "*.md"
        - "*.template"
    
    testing:
      test_framework: "validation-scripts"
      test_directory: "scripts"
      test_file_pattern: "validate_*.py|test_*.sh"
      test_command: "python scripts/validate_context_blocks.py"
      coverage_required: false
      coverage_threshold: 0
      
    quality:
      linters:
        - name: "yamllint"
          enabled: true
          command: "yamllint"
          args: ["-d", "relaxed"]
          file_pattern: "*.yaml|*.yml"
        - name: "markdownlint"
          enabled: false
          command: "markdownlint"
          args: ["**/*.md"]
          file_pattern: "*.md"
      
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      api_documentation_required: false
    
    dependencies:
      package_files: []
      lock_files: []
      validation_required: false
      security_audit_required: false
    
    build:
      required: false
      build_command: ""
      output_directory: ""
    
    deployment:
      type: "git-submodule"
      requires_build: false
      artifact_patterns:
        - "config/**/*.yaml"
        - "config/**/*.template"
        - "docs/**/*.md"
        - "examples/**/*"
        - "scripts/**/*"
        - "github/workflows/**/*.yml"
    
    # Configuration library specific best practices
    ai_guidance:
      testing_standards:
        - "Validate YAML syntax and schema consistency"
        - "Test placeholder substitution patterns"
        - "Verify example configurations are valid"
        - "Validate documentation context blocks with validation scripts"
        - "Test template files can be copied and customized"
      
      style_guides:
        - "Follow YAML style guide (2-space indentation, quoted strings)"
        - "Use consistent placeholder format: {{PLACEHOLDER_NAME}}"
        - "Maintain clear separation between templates and examples"
        - "Document all placeholders in README.md"
      
      best_practices:
        - "Keep templates language-agnostic where possible"
        - "Version configuration schemas explicitly"
        - "Provide working examples for each template"
        - "Document integration patterns clearly"
        - "Maintain backward compatibility within major versions"
        - "Use .template extension for files requiring customization"
        - "Keep configuration files self-documenting with comments"
        - "Separate metadata files (.github/) from templates (github/)"
      
      directory_standards:
        - "config/ for all configuration templates and schemas"
        - "docs/ for comprehensive documentation"
        - "examples/ for language-specific integration examples"
        - "scripts/ for utility scripts (use .template extension)"
        - "github/ for GitHub Actions workflow templates"
        - ".github/ for GitHub platform metadata (DESCRIPTION.md, copilot-instructions.md)"

  # ----------------------------------------------------------------------------
  # AWS Location-Based Service Backend Setup
  # ----------------------------------------------------------------------------
  aws_lbs_backend_setup:
    name: "AWS LBS Backend Setup"
    description: "Serverless AWS backend using Lambda, API Gateway, and AWS Location Service, provisioned via shell scripts"

    # Auto-detection indicators used by project_kind_detection.js
    detection:
      file_indicators:
        - "aws-config.json"       # Generated AWS resource identifiers
        - "setup-aws-lbs.sh"      # Root-level orchestration script
      directory_indicators:
        - "src/lambda"            # Lambda function handlers
        - "src/scripts"           # Infrastructure/deployment shell scripts
      required_combination:
        - "aws-config.json + *.sh + *.js"  # Mixed shell + Lambda JS + AWS config
      confidence: 85

    # Validation rules
    validation:
      required_files:
        - "*.sh"
        - "src/aws-config.json"
      required_directories:
        - "src/lambda"
        - "src/scripts"
      optional_files:
        - "README.md"
        - ".gitignore"
        - "setup-aws-lbs.sh"
      file_patterns:
        - "*.sh"
        - "*.js"
        - "*.json"

    # Test execution configuration
    testing:
      test_framework: "none"
      test_directory: ""
      test_file_pattern: ""
      test_command: ""
      coverage_required: false
      coverage_threshold: 0

    # Quality standards
    quality:
      linters:
        - name: "shellcheck"
          enabled: true
          command: "shellcheck"
          args: ["-x", "-S", "warning"]
          file_pattern: "*.sh"
      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      api_documentation_required: true
      api_documentation_format: "markdown"

    # Dependencies configuration
    dependencies:
      package_files: ["src/lambda/*/package.json"]
      lock_files: ["src/lambda/*/package-lock.json"]
      validation_required: true
      security_audit_required: true
      audit_command: "npm audit --prefix src/lambda/<function>"

    # Build configuration
    build:
      required: true
      build_command: "npm install --production && zip -r function.zip ."
      output_directory: "src/lambda"

    # Deployment configuration
    deployment:
      type: "serverless"
      requires_build: true
      artifact_patterns:
        - "*.sh"
        - "src/scripts/*.sh"
        - "src/lambda/**/*.js"
        - "src/lambda/**/package.json"
        - "src/aws-config.json"
      environment_required: true

    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Verify AWS resources exist after setup with 'aws <service> describe/list' commands"
        - "Smoke-test API endpoints with curl after deployment"
        - "Validate Lambda function invocations via aws lambda invoke"
        - "Check CloudWatch Logs for runtime errors after each deployment"
        - "Test CORS headers with an OPTIONS preflight request"

      style_guides:
        - "Google Shell Style Guide for provisioning scripts"
        - "AWS Lambda Node.js best practices"
        - "AWS Well-Architected Framework — Serverless Lens"

      best_practices:
        - "Make all provisioning scripts idempotent (create-or-update semantics)"
        - "Store generated ARNs and IDs in src/aws-config.json; never hardcode them"
        - "Use least-privilege IAM policies scoped to specific resource ARNs"
        - "Read ALLOWED_ORIGIN from environment variables at Lambda runtime, not at deploy time"
        - "Package Lambda dependencies with npm install --production before zipping"
        - "Use set -euo pipefail in every shell script for strict error handling"
        - "Support AWS_REGION and ALLOWED_ORIGIN overrides via environment variables"
        - "Use jq for all JSON parsing in shell scripts; avoid grep/sed on JSON"
        - "Log meaningful progress messages (Step X/N: ...) in provisioning scripts"
        - "Add a cleanup section to README.md with explicit aws CLI delete commands"
        - "Implement CORS on both API Gateway level and Lambda response headers"
        - "Stream Lambda logs with 'aws logs tail --follow' for live debugging"

      directory_standards:
        - "Root-level orchestration script (setup-aws-lbs.sh) calls sub-scripts in order"
        - "src/scripts/ for infrastructure setup and deployment shell scripts"
        - "src/lambda/<function-name>/ for each Lambda handler with its own package.json"
        - "src/aws-config.json for generated AWS resource identifiers (not committed)"
        - "README.md at root and src/lambda/<function-name>/ documenting the API contract"

      aws_architecture_patterns:
        - "API Gateway HTTP API (v2) + Lambda integration for low-latency REST endpoints"
        - "Separate Lambda functions per route for single-responsibility"
        - "AWS Location Service for geocoding and map tile serving"
        - "Lambda resource-based policy to authorize API Gateway invocations"
        - "CloudWatch log groups automatically created per Lambda function"
        - "Environment variables injected at deploy time for region, resource names, and CORS origin"

  # ----------------------------------------------------------------------------
  # Location-Based Service (LBS) Client SPA
  # ----------------------------------------------------------------------------
  location_based_service:
    name: "Location-Based Service"
    description: "Geolocation-aware client SPA with map display, POI browsing, reverse geocoding, and location tracking (e.g., tourist guides, city explorers, geo-search apps)"

    # Auto-detection indicators used by project_kind_detection.js
    detection:
      package_json_keywords:
        - "geolocation"
        - "location"
        - "maps"
        - "gps"
        - "tourist-guide"
        - "poi"
      package_json_dependencies:
        - "guia.js"
        - "ibira.js"
        - "leaflet"
        - "maplibre-gl"
        - "mapbox-gl"
        - "@aws-amplify/geo"
        - "@aws-sdk/client-location"
      file_indicators:
        - "GeolocationService.js"
        - "GeoPosition.js"
        - "ReverseGeocoder.js"
        - "PositionManager.js"
      confidence: 85

    # Validation rules
    validation:
      required_files:
        - "index.html|public/index.html|src/index.html"
        - "package.json"
        - "src/**/*.js"
      required_directories:
        - "src"
      optional_files:
        - "README.md"
        - "vite.config.js|webpack.config.js"
        - "jest.config.js|jest.config.unit.js"
        - "eslint.config.js"
        - "service-worker.js|sw.js"
        - ".env.example"
        - "manifest.json"
      file_patterns:
        - "*.html"
        - "*.css"
        - "*.js"
        - "*.mjs"
      excluded_patterns:
        - "*.jsx"
        - "*.tsx"
        - "*.vue"
        - "angular.json"

    # Test execution configuration
    testing:
      test_framework: "jest|playwright|selenium"
      test_directory: "__tests__|tests"
      test_file_pattern: "*.test.js|*.spec.js|*.e2e.test.js"
      test_command: "npm test"
      e2e_command: "npm run test:e2e"
      coverage_required: true
      coverage_threshold: 65

    # Quality standards
    quality:
      linters:
        - name: "eslint"
          enabled: true
          command: "npx eslint"
          args: ["src/**/*.js"]
          file_pattern: "*.js|*.mjs"
        - name: "htmlhint"
          enabled: true
          command: "npx htmlhint"
          args: ["**/*.html"]
          file_pattern: "*.html"
        - name: "stylelint"
          enabled: true
          command: "npx stylelint"
          args: ["src/**/*.css"]
          file_pattern: "*.css"

      documentation_required: true
      inline_comments_recommended: true
      readme_required: true
      api_documentation_required: true
      accessibility_required: true
      wcag_level: "AA"

    # Dependencies configuration
    dependencies:
      package_files: ["package.json"]
      lock_files: ["package-lock.json", "yarn.lock", "pnpm-lock.yaml"]
      validation_required: true
      security_audit_required: true
      audit_command: "npm audit"

    # Build configuration
    build:
      required: false
      build_command: "npm run build"
      output_directory: "dist|build|public"
      dev_server: "npm run dev"

    # Deployment configuration
    deployment:
      type: "static"
      requires_build: false
      artifact_patterns:
        - "public/**/*"
        - "dist/**/*"
        - "index.html"
        - "src/**/*.js"
        - "src/**/*.css"
        - "service-worker.js"
        - "manifest.json"
      cdn_compatible: true
      pwa_compatible: true

    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Mock the browser Geolocation API (navigator.geolocation) in unit tests"
        - "Test error paths: permission denied, position unavailable, timeout"
        - "Mock map tile providers and geocoding APIs with recorded fixtures"
        - "Test service worker registration and offline caching behaviour"
        - "Validate coordinate precision and bounding-box calculations"
        - "Use Playwright/Puppeteer for E2E tests that require real browser GPS APIs"
        - "Test POI list rendering with varied API response shapes (empty, partial, full)"
        - "Verify location-privacy guards (no coordinates exposed in logs or URLs)"

      style_guides:
        - "Airbnb JavaScript Style Guide (ES6+)"
        - "W3C Geolocation API specification patterns"
        - "Vanilla JS Best Practices (avoiding jQuery)"
        - "HTML5 semantic markup guidelines"
        - "CSS BEM methodology for custom styles"

      best_practices:
        - "Always request geolocation lazily (on user gesture) — never on page load"
        - "Implement AbortController / watchId cleanup to prevent memory leaks"
        - "Cache the last known position in sessionStorage with a TTL"
        - "Provide a manual address-search fallback when GPS is unavailable"
        - "Use Geolocation API with maximumAge and timeout options configured"
        - "Normalise coordinates to WGS-84 and validate range (-90≤lat≤90, -180≤lon≤180)"
        - "Never log raw user coordinates; hash or truncate for analytics"
        - "Implement a service worker for offline POI tile caching (PWA)"
        - "Show progressive loading states: coarse location → refined location"
        - "Handle map tile 429/503 errors gracefully with a retry strategy"
        - "Use vector tiles or cached raster tiles to minimise data usage"
        - "Support reduced-motion preference for map fly-to animations"
        - "Provide ARIA live regions for screen-reader announcements of location updates"
        - "Use ES6+ modules (import/export) and avoid global namespace pollution"
        - "Implement proper CORS handling for geocoding and tile API calls"

      directory_standards:
        - "HTML entry point in root or src/ directory"
        - "Geolocation and map services in src/services/ or src/core/"
        - "POI data fetching and caching in src/services/ (e.g., PoiService.js)"
        - "Map rendering logic in src/components/ or src/views/"
        - "Coordinate utilities (distance, bounding box) in src/utils/"
        - "Stylesheets in src/ or public/css/"
        - "Static assets (icons, tile placeholders) in public/ or assets/"
        - "Service worker at project root (service-worker.js or sw.js)"
        - "Web app manifest (manifest.json) at project root"
        - "Tests in __tests__/ (unit) and tests/ (integration/E2E)"
        - "Build output in dist/ directory"
        - "Documentation in docs/"

      geolocation_patterns:
        - "Wrap navigator.geolocation in a provider class for easy mocking (GeolocationProvider)"
        - "Implement observer/subscriber pattern for position updates (ObserverSubject)"
        - "Use a PositionManager to debounce rapid GPS updates"
        - "Separate geocoding (address→coords) from reverse geocoding (coords→address) services"
        - "Support multiple geocoding providers with a strategy pattern (AWS, OpenStreetMap, etc.)"
        - "Store provider configuration in a config object, not hardcoded URLs"

      pwa_patterns:
        - "Register service worker only in production (check import.meta.env.PROD)"
        - "Cache map tiles with a Cache-First strategy; API responses with Network-First"
        - "Implement background sync for queued POI reviews or favourites"
        - "Include a valid Web App Manifest with geo-appropriate icons and theme colours"
        - "Test offline mode: app should render cached POIs when network is unavailable"

  # ----------------------------------------------------------------------------
  # Generic Project (Fallback)
  # ----------------------------------------------------------------------------
  generic:
    name: "Generic Project"
    description: "Generic project with minimal assumptions"
    
    validation:
      required_files: []
      required_directories: []
      optional_files:
        - "README.md"
      file_patterns: ["*"]
    
    testing:
      test_framework: "unknown"
      test_directory: "tests|test"
      test_file_pattern: "test_*|*_test.*|*.test.*|*.spec.*"
      test_command: ""
      coverage_required: false
      coverage_threshold: 0
      
    quality:
      linters: []
      documentation_required: true
      inline_comments_recommended: false
      readme_required: true
    
    dependencies:
      package_files: []
      lock_files: []
      validation_required: false
    
    build:
      required: false
      build_command: ""
      output_directory: ""
    
    deployment:
      type: "unknown"
      requires_build: false
      artifact_patterns: []
    
    # Language-specific best practices and standards
    ai_guidance:
      testing_standards:
        - "Follow language-appropriate testing framework conventions"
        - "Test critical functionality thoroughly"
        - "Include both positive and negative test cases"
        - "Mock external dependencies appropriately"
      
      style_guides:
        - "Follow language-specific style guides"
        - "Maintain consistent code formatting"
      
      best_practices:
        - "Write clear, self-documenting code"
        - "Follow SOLID principles where applicable"
        - "Handle errors appropriately"
        - "Add comments for complex logic"
        - "Keep functions focused and concise"
        - "Use meaningful variable and function names"
      
      directory_standards:
        - "Follow language/framework conventional structure"
        - "Separate source, tests, and documentation"
        - "Keep configuration files organized"
        - "Use conventional directory names"

# ============================================================================
# CONFIGURATION METADATA
# ============================================================================

metadata:
  schema_version: "1.5.0"
  last_updated: "2026-02-22"
  compatible_workflow_version: "2.3.1"
  changelog:
    - version: "1.5.0"
      date: "2026-02-22"
      changes: "Added location_based_service project kind for geolocation-aware client SPAs (tourist guides, map apps, POI browsers)"
    - version: "1.4.0"
      date: "2026-02-21"
      changes: "Added nodejs_automation project kind for Node.js CLI tools and automation frameworks"
    - version: "1.3.1"
      date: "2026-02-20"
      changes: "Enhanced aws_lbs_backend_setup with detection section documenting file/directory indicators for auto-detection"
    - version: "1.3.0"
      date: "2026-02-20"
      changes: "Added aws_lbs_backend_setup project kind for serverless AWS Location-Based Service backends"
    - version: "1.2.0"
      date: "2026-01-30"
      changes: "Added configuration_library project kind for template/config repositories"
    - version: "1.1.0"
      date: "2025-12-22"
      changes: "Added client_spa project kind for vanilla JS SPAs with Bootstrap"
    - version: "1.0.0"
      date: "2025-12-18"
      changes: "Initial project kinds configuration"
